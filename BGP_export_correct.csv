ArticleId,template_name,Key,Status,Expert,Interested person,Steward,Person working on,To be Maintained,1. Definition,1. Function,2. Business Function,2. Calculations,3.1Qlik Aggregate Rules,3. Data Preparation Rules,4.1 Split by Segment,4.2 Past DSL Queries,4. Queries,4. Sub-BTO,5. Access Request,Business Domains,Singular,Owner,Franchise,3. BTO,Relevant Data,Compliance Object,Approval Date,Relevant Data1,4.1 Split by Segment:sub,4.2 Past DSL Queries:sub,4. Queries:sub
403,BGP,GP,,,,,,,,,,,"Only eligible territories are included at the District, Region, and Franchise levels. ",,"/* Territory Level*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,
SEGMENT_NAME,SEGMENT_VALUE,NO_OF_FOLLOWUP_ATTENDEE
 from adsVp.DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
where franchise=${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME&lt;&gt; 'OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE,SEGMENT_NAME,SEGMENT_VALUE

/* State Level*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,
SEGMENT_NAME,SEGMENT_VALUE,NO_OF_FOLLOWUP_ATTENDEE
 from adsVp.DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW

/* Distric Level*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,
SEGMENT_NAME,SEGMENT_VALUE,NO_OF_FOLLOWUP_ATTENDEE
 from adsVp.DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
where franchise=${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME&lt;&gt; 'OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE,SEGMENT_NAME,SEGMENT_VALUE
/* Region Level*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,
SEGMENT_NAME,SEGMENT_VALUE,NO_OF_FOLLOWUP_ATTENDEE
 from adsVp.DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW

","/* Territory Level*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,
SEGMENT_NAME,SEGMENT_VALUE,NO_OF_FOLLOWUP_ATTENDEE
 from adsVp.DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
where franchise=${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME&lt;&gt; 'OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE,SEGMENT_NAME,SEGMENT_VALUE

/* District Level*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,
SEGMENT_NAME,SEGMENT_VALUE,NO_OF_FOLLOWUP_ATTENDEE
 from adsVp.DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
where franchise=${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME&lt;&gt; 'OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE,SEGMENT_NAME,SEGMENT_VALUE

/* Region Level*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,
SEGMENT_NAME,SEGMENT_VALUE,NO_OF_FOLLOWUP_ATTENDEE
 from adsVp.DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
where franchise=${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME&lt;&gt; 'OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE,SEGMENT_NAME,SEGMENT_VALUE

/* Franchise Level*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,
SEGMENT_NAME,SEGMENT_VALUE,NO_OF_FOLLOWUP_ATTENDEE
 from adsVp.DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
where franchise=${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME&lt;&gt; 'OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE,SEGMENT_NAME,SEGMENT_VALUE",,,,Sales,,Priya Shivgnanam
429,BGP,Number of Attendees,,,,,,,The total number of Attendees,,,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


selectFRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEESfrom( SELECTTOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,TOTAL_CALLS.CAMPAIGN_YEAR,TOTAL_CALLS.CAMPAIGN_PERIOD,CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEESFROM( SELECTA.FRANCHISE,B.PARAMETER_VALUE HIERARCHY_LEVEL,CASEWHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBERWHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICTWHEN B.PARAMETER_VALUE='REGION' THEN REGIONWHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISEEND HIERARCHY_CODE,CAST('OVERALL' AS VARCHAR(100)) AS SEGMENT_NAME,CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR,SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEESFROM(SELECTFRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEESFromADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT --WhereCALL_TYPE = 'PHARMACY'GROUP BYFRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION ) AINNER JOIN(SELECTDISTINCT PARAMETER_VALUE,PARAMETER_VALUE1FROMADSP.SEMANTIC_DATA_CONTROLWHEREPARAMETER_NAME='HIERARCHY_ROLLUP'AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP') BON 1=1INNER JOIN(SELECTDISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATEFROMADSP.AGG_CALL_PLAN_METRIC_FACT AGGINNER JOINADSP.DIM_CALL_CAMPAIGN_PERIOD CON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODEAND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEARAND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIODAND C.ADS_ACTIVE_FLAG='Y'WHEREAGG.CURRENT_WEEK_FLAG='Y') AGG_FACTON A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODEAND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATEGROUP BYA.FRANCHISE,B.PARAMETER_VALUE,CASEWHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBERWHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICTWHEN B.PARAMETER_VALUE='REGION' THEN REGIONWHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISEEND,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR ) TOTAL_CALLS )CURRwherefranchise='Womens Health' --${Franchise Name|Pick the Franchise Namefromthe List|Help: FilterbyFranchise|String}AND SEGMENT_NAME='OVERALL'AND HIERARCHY_LEVEL='FRANCHISE'order byhierarchy_CODE/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE




    
    select
        FRANCHISE,
        HIERARCHY_LEVEL,
        HIERARCHY_CODE,
        SEGMENT_NAME,
        TOTAL_ATTENDEES 
    from
        ( SELECT
            TOTAL_CALLS.FRANCHISE,
            TOTAL_CALLS.HIERARCHY_LEVEL,
            TOTAL_CALLS.HIERARCHY_CODE,
            TOTAL_CALLS.SEGMENT_NAME,
            TOTAL_CALLS.SEGMENT_VALUE,
            TOTAL_CALLS.CAMPAIGN_YEAR,
            TOTAL_CALLS.CAMPAIGN_PERIOD,
            CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,
            2)) AS TOTAL_ATTENDEES 
        FROM
            ( SELECT
                A.FRANCHISE,
                B.PARAMETER_VALUE HIERARCHY_LEVEL,
                CASE 
                    WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER 
                    WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT 
                    WHEN B.PARAMETER_VALUE='REGION' THEN REGION 
                    WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE 
                END HIERARCHY_CODE,
                CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
                CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
                AGG_FACT.CAMPAIGN_PERIOD,
                AGG_FACT.CAMPAIGN_YEAR,
                SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES 
            FROM
                (SELECT
                    FRANCHISE,
                    SALES_FORCE_CODE,
                    CALL_ACTIVITY_DATE,
                    TERRITORY_NUMBER ,
                    DISTRICT,
                    REGION,
                    count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES 
                From
                    ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT --
                Where
                    CALL_TYPE = 'PHARMACY' 
                GROUP BY
                    FRANCHISE,
                    SALES_FORCE_CODE,
                    CALL_ACTIVITY_DATE,
                    TERRITORY_NUMBER,
                    DISTRICT,
                    REGION ) A 
            INNER JOIN
                (
                    SELECT
                        DISTINCT PARAMETER_VALUE,
                        PARAMETER_VALUE1 
                    FROM
                        ADSP.SEMANTIC_DATA_CONTROL 
                    WHERE
                        PARAMETER_NAME='HIERARCHY_ROLLUP' 
                        AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' 
                ) B 
                    ON 1=1 
            INNER JOIN
                (
                    SELECT
                        DISTINCT AGG.SALES_FORCE_CODE,
                        AGG.CAMPAIGN_YEAR,
                        AGG.CAMPAIGN_PERIOD,
                        C.ORIGINAL_CAMPAIGN_START_DATE,
                        C.ORIGINAL_CAMPAIGN_END_DATE 
                    FROM
                        ADSP.AGG_CALL_PLAN_METRIC_FACT AGG 
                    INNER JOIN
                        ADSP.DIM_CALL_CAMPAIGN_PERIOD C 
                            ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE 
                            AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR 
                            AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD 
                            AND C.ADS_ACTIVE_FLAG='Y' 
                    WHERE
                        AGG.CURRENT_WEEK_FLAG='Y' 
                ) AGG_FACT 
                    ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE 
                    AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE 
            GROUP BY
                A.FRANCHISE,
                B.PARAMETER_VALUE,
                CASE 
                    WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER 
                    WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT 
                    WHEN B.PARAMETER_VALUE='REGION' THEN REGION 
                    WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE 
                END,
                AGG_FACT.CAMPAIGN_PERIOD,
                AGG_FACT.CAMPAIGN_YEAR ) TOTAL_CALLS )CURR 
            where
                franchise='Womens Health' --${Franchise Name|Pick the Franchise Name 
            from
                the List|Help: Filter 
            by
                Franchise|String} 
                AND SEGMENT_NAME='OVERALL' 
                AND HIERARCHY_LEVEL='FRANCHISE' 
            order by
                hierarchy_CODE 
",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam
807,BGP,PR_ART_01,,,,,,,The total number of Attendees,,,,,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations
816,BGP,No of Attendees,,,,,,,The total number of Attendees,,,,,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations
842,BGP,PR_ART_02,,,,,,,The total number of Attendees,,Commercial+Q19J19:O19J19:Q19,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US
851,BGP,PR_ART_03,,,,,,,The total number of Attendees,,Commercial+Q19J19:O19J19:Q19,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
860,BGP,numb1 of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
869,BGP,numb2 of Attendees,,,,,,,The total number of Attendees,,Commercial,,1234,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
870,BGP,numb2 of Attendees,,,,,,,The total number of Attendees,,,,,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE"
900,BGP,Friday1,,,,,,,The total number of Attendees,,Commercial,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level01 */
selEct FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
902,BGP,Manimala_1,,,,,,,The total number of Attendees,,Commercial+Q19J19:O19J19:Q19,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
904,BGP,Mani_01,,,,,,,The total number of Attendees,,Commercial,,"""""",,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Subhapriya,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
906,BGP,numb of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
944,BGP,Test_Gow_001,,,,,,,The total number of Attendees,,Commercial,,1234,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
963,BGP,Test_Article_G0709,,,,,,,The total number of Attendees,,Commercial,,1234,,"/* Territory12345 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE
","/* Territory past level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
974,BGP,numb4 of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* country level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
994,BGP,numb5 of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* country1 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* state1 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1004,BGP,numb7 of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* country2 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* state2 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1013,BGP,numb10 of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* 1country2 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* 12state2 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1022,BGP,numb11 of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* 1country2 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* 12state2 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1031,BGP,numb18of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* 1country2 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* 12state2 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1041,BGP,numb101 of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* 1country21 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* 12state21 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1050,BGP,numb102 of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* Territory level100919 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1060,BGP,numb103 of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* 11country2 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE
/* state21 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE


","/* 112state2 level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1071,BGP,numb106 of Attendees,,,,,,,The total number of Attendees,,Commercial,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1076,BGP,Sep-10,,,,,,,,,,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1085,BGP,Sample09sep,,,,,,,,,,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1094,BGP,tuesday09,,,,,,,,,,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1103,BGP,tuesday0901,,,,,,,,,,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1112,BGP,tuesday0902,,,,,,,,,,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1121,BGP,tuesday0903,,,,,,,,,,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



/* Franchise level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='FRANCHISE'
order by hierarchy_CODE",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1130,BGP,tuesday0904,,,,,,,,,,,123,,"/* Territory level01 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1134,BGP,tuesdaycsvsep10,,,,,,,,,,,123,,"/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1137,BGP,GowB1,,,,,,,,,,,123,,"/* Territory level 01*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1144,BGP,Priya02,,,,,,,,,,,123,,"/* Territory level01 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1147,BGP,DemoCSVLoader,,,,,,,,,,,123,,"/* Territory level 01*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1150,BGP,DCSV,,,,,,,,,,,123,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,,,Operations,,Priya Shivgnanam,,,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1153,BGP,1_DCSV,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1156,BGP,2_DCSV,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level01 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1161,BGP,3_DCSV,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level0465*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level555 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1167,BGP,4_DCSV,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1170,BGP,4_1DCSV,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level1 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level1235544 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1176,BGP,1Demo_CSVLoader,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level 1*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1179,BGP,9SepDemoCsv,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level0123 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level012556 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1182,BGP,parentid,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level01*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level01 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1187,BGP,9Sep2019DemoCsv,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level01*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level01*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1191,BGP,D11sep,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level 1*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level1 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1195,BGP,D11sep_1,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level02*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level1 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level1 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1199,BGP,D11sep_02,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level3rd*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level3rd*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1205,BGP,D11sep_03,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level02*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1211,BGP,D11sep_044,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1215,BGP,D11sep_045,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1219,BGP,D11sep_046,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1225,BGP,D11sep_B,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level012563*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1229,BGP,D11sep_A,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1235,BGP,D11sep_C,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level1 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1244,BGP,D11sep_D,,,,,,,The total number of Attendees,Commercial,Commercial,Sample data,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1248,BGP,aaagfdsd,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1252,BGP,AbbVie_Demo,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1256,BGP,AbbVie_Demo_12,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level01*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1260,BGP,,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1265,BGP,AbbVie_Demo_14,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1269,BGP,AbbVie_Demo_15,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1273,BGP,AbbVie_Demo_16,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1277,BGP,test,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1278,BGP,test,,,,,,,,,,,,,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



"
1279,BGP,AbbVie_Demo_13,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1290,BGP,AbbVie_Demo_Sep13,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1294,BGP,AbbVie_Demo_Sep14,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1302,BGP,AbbVie_Demo_Sep15,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1306,BGP,AbbVie_Demo_Sep16,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1310,BGP,AbbVie_Demo_Sep17,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level01*/
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1315,BGP,AbbVie_Demo_Sep18,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1319,BGP,AbbVie_Demo_Sep19,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1323,BGP,AbbVie_Demo_GP,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level5454 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1326,BGP,Metrics_Template_v1,,,,,,,The total number of Attendees,Commercial,Commercial,Sample data,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level5454 */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1330,BGP,temp1,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level01Thiag */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1331,BGP,AbbVie_Demo_GP_sep,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
1343,BGP,AbbVie_Demo_16sep,,,,,,,The total number of Attendees,Commercial,Commercial,N/A - can Alation skip this field if N/A is entered?,123,CALL_ACTIVITY_DSL_RULES,"/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE
/* state level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE

/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


","/* Territory level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 ( TOTAL_CALLS)CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='TERRITORY'
order by hierarchy_CODE


/* District level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from 
 (
 SELECT TOTAL_CALLS.FRANCHISE,TOTAL_CALLS.HIERARCHY_LEVEL,TOTAL_CALLS.HIERARCHY_CODE,TOTAL_CALLS.SEGMENT_NAME,TOTAL_CALLS.SEGMENT_VALUE,
TOTAL_CALLS.CAMPAIGN_YEAR,
TOTAL_CALLS.CAMPAIGN_PERIOD,
CAST(TOTAL_CALLS.TOTAL_ATTENDEES AS DECIMAL(10,2)) AS TOTAL_ATTENDEES
FROM 
(
SELECT A.FRANCHISE,
B.PARAMETER_VALUE HIERARCHY_LEVEL,
CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END HIERARCHY_CODE,
CAST('OVERALL' AS VARCHAR(100)) AS  SEGMENT_NAME,
CAST('OVERALL' AS VARCHAR(100) )AS SEGMENT_VALUE,
AGG_FACT.CAMPAIGN_PERIOD,
AGG_FACT.CAMPAIGN_YEAR,
SUM(TOTAL_ATTENDEES) AS TOTAL_ATTENDEES
FROM
(SELECT FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER ,DISTRICT,REGION,
count(Distinct ABBOTT_CUSTOMER_ID) AS TOTAL_ATTENDEES
From ADSP.CALL_ACTIVITY_TOUCHPOINTS_FACT
--Where CALL_TYPE = 'PHARMACY'
GROUP BY FRANCHISE,SALES_FORCE_CODE,CALL_ACTIVITY_DATE,TERRITORY_NUMBER,DISTRICT,REGION
) A
INNER JOIN
(SELECT DISTINCT PARAMETER_VALUE,PARAMETER_VALUE1 FROM ADSP.SEMANTIC_DATA_CONTROL WHERE PARAMETER_NAME='HIERARCHY_ROLLUP' AND PROCESS_NAME='GEO_HIERARCHY_ROLLUP' ) B
ON 1=1  
INNER JOIN 
(
SELECT DISTINCT AGG.SALES_FORCE_CODE,AGG.CAMPAIGN_YEAR,AGG.CAMPAIGN_PERIOD,C.ORIGINAL_CAMPAIGN_START_DATE,C.ORIGINAL_CAMPAIGN_END_DATE FROM ADSP.AGG_CALL_PLAN_METRIC_FACT AGG INNER JOIN ADSP.DIM_CALL_CAMPAIGN_PERIOD C ON AGG.SALES_FORCE_CODE=C.SALES_FORCE_CODE
AND AGG.CAMPAIGN_YEAR=C.CAMPAIGN_YEAR
AND AGG.CAMPAIGN_PERIOD=C.CAMPAIGN_PERIOD
AND C.ADS_ACTIVE_FLAG='Y'
WHERE AGG.CURRENT_WEEK_FLAG='Y'
) AGG_FACT
ON  A.SALES_FORCE_CODE=AGG_FACT.SALES_FORCE_CODE
AND A.CALL_ACTIVITY_DATE BETWEEN AGG_FACT.ORIGINAL_CAMPAIGN_START_DATE AND AGG_FACT.ORIGINAL_CAMPAIGN_END_DATE
GROUP BY A.FRANCHISE,B.PARAMETER_VALUE,CASE WHEN B.PARAMETER_VALUE='TERRITORY' THEN TERRITORY_NUMBER
WHEN B.PARAMETER_VALUE='DISTRICT' THEN DISTRICT
WHEN B.PARAMETER_VALUE='REGION' THEN REGION
WHEN B.PARAMETER_VALUE='FRANCHISE' THEN A.FRANCHISE END,AGG_FACT.CAMPAIGN_PERIOD,AGG_FACT.CAMPAIGN_YEAR
) TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='DISTRICT'
order by hierarchy_CODE


/* Region level */
select FRANCHISE,HIERARCHY_LEVEL,HIERARCHY_CODE,SEGMENT_NAME,TOTAL_ATTENDEES
 from  TOTAL_CALLS
 )CURR
where franchise='Womens Health'
--${Franchise Name|Pick the Franchise Name from the List|Help: Filter by Franchise|String}
AND SEGMENT_NAME='OVERALL'
AND HIERARCHY_LEVEL='REGION'
order by hierarchy_CODE



",,Commercial,No History data in DSL,Operations,,Priya Shivgnanam,,Commercial US,DSL_SPKR_EVNT_FLWUP_CUR_QTR_VW
